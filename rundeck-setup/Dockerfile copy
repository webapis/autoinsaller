# Use your desired Rundeck version as base
FROM rundeck/rundeck:4.10.0

# Switch to root to install packages
USER root

# Install Python 3 and pip
RUN apt-get update && \
    apt-get install -y python3 python3-pip && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Install the pywinrm library (required for the PyWinRM plugin)
RUN pip3 install --no-cache-dir pywinrm

# Optional: Install additional libraries for Kerberos/CredSSP support (if needed)
# RUN pip3 install --no-cache-dir requests-kerberos requests-credssp

# Switch back to the rundeck user
USER rundeck